\documentclass[10pt]{article}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{mhchem}
\usepackage{stmaryrd}
\usepackage{graphicx}
\usepackage[export]{adjustbox}
\graphicspath{ {./images/} }
\usepackage{hyperref}
\hypersetup{colorlinks=true, linkcolor=blue, filecolor=magenta, urlcolor=cyan,}
\urlstyle{same}

\title{General Method for Calculating Satellite Collision Probability }


\author{Russell P. Patera\\
The Aerospace Corporation, El Segundo, California 90245-4691}
\date{}


\begin{document}
\maketitle
Article in Journal of Guidance, Control, and Dynamics Â· July 2001

Dol: $10.2514 / 2.4771$

1 author:

Russell P. Patera

Retired from The Aerospace Corporation

69 PUBLICATIONS 693 CITATIONS

SEE PROFILE

\section{Some of the authors of this publication are also working on these related projects:}
\section{Orbital collision risk View project}
Launch vehicle guidance and analysis View project

\section*{General Method for Calculating Satellite Collision Probability }


\begin{abstract}
A method of calculating the collision probability between two orbiting objects given the respective state vectors and error covariance matrices is developed. The methodology is valid for the general case and does not require simplifying assumptions. It is computationally efficient and applicable to satellites of irregular shape. Analytical techniques are used to reduce the problem to that of integrating a two-dimensional symmetric probability density over a region representing the combined hard body of the colliding objects. The symmetric form of the probability density enables the two-dimensional integral to be reduced to a one-dimensional path integral that permits easy numerical implementation and reduces computational effort. Test case results are in good agreement with those generated by other collision probability tools.
\end{abstract}

\section{Nomenclature}
$a, c, d,=$ auxiliary parameters

$e, f, g$

$=$ two-dimension probability density

$J \quad=$ number of steps between vertices of asymmetric hard body

$M \quad=$ matrix characterizing the size of the ellipse

$n=$ subinterval index between vertices of asymmetric hard body

$\boldsymbol{q} \quad=$ displacement vector between objects at closest approach

$\boldsymbol{q}_{r} \quad=\boldsymbol{q}$ after a rotation to diagonalize the probability density

$\boldsymbol{q}_{r s} \quad=\boldsymbol{q}_{r}$ after a scale change

$R=$ rotation matrix for numerical integration

$s \quad=$ initial hard-body radius of combined objects

$T=$ transformation matrix to diagonalized the two-dimensional probability density

$U \quad=$ transformation matrix from encounter to diagonal frame

$u \quad=$ function defining hard-body radius

$x, y, z=$ coordinates used in probability density function

$\boldsymbol{x} \mathbf{1}, \boldsymbol{x} \mathbf{2}=$ adjacent vertices of asymmetric hard-body

$\boldsymbol{X}_{e} \quad=$ distance from origin to surface of ellipse in the encounter frame

$\boldsymbol{X}_{m} \quad=$ distance from center of ellipse to a point on its surface

$\boldsymbol{X}_{n}, \boldsymbol{X}_{n}^{\prime}=n$th step between vertices of asymmetric hard body

$\alpha \quad=$ coefficient defining probability density

$\beta \quad=$ coefficient defining probability density

$\varepsilon \quad=$ small rotation angle for propagating around the hard-body ellipse

$\theta \quad=$ integration parameter

$\rho \quad=$ three-dimensional probability density function

$\sigma_{x, y, z}=$ standard deviations for each axis $\varphi$ $=$ rotation angle to eliminate the cross term in the two-dimensional probability density

\section{Introduction}
THE possibility of a satellite colliding with space debris or anher satellite is becoming more likely as the number of objects in Earth orbit increases. One method of mitigating the risk of an on-orbit collision is to perform a collision avoidance maneuver whenever a close approach with another tracked object is predicted. The space shuttle must perform a collision avoidance maneuver whenever a tracked object is predicted to violate a keep-out volume of $5 \times 2 \times 2 \mathrm{~km}$ centered on the Orbiter ${ }^{1}$ Because launch vehicles of $5 \times 2 \times 2 \mathrm{~km}$ centered on the Orbiter.' Because launch vehicles can pose risk to crewed and operational vehicles, ascent trajectories are checked for possible close approachesfor a range of launch times spanning the launch window. 2,3 A disadvantage of the keepout volume criterion is that it does not quantify the collision risk. It is preferable to compute a collision probability so that the collision risk can be traded off against the inherent risks of performing a collision avoidance maneuver. Such a calculation requires information on state vector accuracy characterized by the error covariance matrix of each object.

Some researchers have been searching for an effective formulation and computer implementation of this collision probability calculation problem, ${ }^{4}$ and significant progress has been made in recent years. Chan showed that it is permissible to combine the error covariance matrices for two orbiting objects to obtain a relative covariance matrix as long as they are represented in the same coordinate frame ${ }^{5}$ The combined covariance matrix has an associated three-dimensional probability density function that represents the uncertainty in relative position between the two objects.

Several analysts have found that the problem can be reduced to two dimensions by eliminating the dimension parallel to the relative velocity vector. ${ }^{5-9}$ When each satellite is assumed to have a spherical shape, the collision probability can be reduced to a two-dimensionalintegralover a circular region in a plane normal to

Russell Patera received a B.A. and M.A. in physics from the State University of New York and a Ph.D. in physics from the University of Miami in 1979. He served as Assistant Professor of physics at the University of Miami and Florida International University prior to joining Vought Aerospace (previously LTV) in 1984. He joined the Aerospace Corporation in 1987, specializing in dynamics, guidance, and control of both launch vehicles and satellites. He joined the Center for Orbital and Reentry Debris Studies in 1997 and is currently involved in orbital and reentry debris hazard analysis.

Received 24 February 2000; revision received 28 August 2000; accepted for publication 1 November 2000. Copyright (C) 2001 by Russell P. Patera. Published by the American Institute of Aeronautics and Astronautics, Inc., with permission. the relative velocity vector referred to as the encounter frame. ${ }^{5-9}$ If the probability density is nearly constant over the circularintegration region, then the probability is approximately equal to the area times the probability density at the center of the circular region.

Although the mathematical foundation of the two-dimensional integral is solid, Berend ${ }^{9}$ validated it with Monte Carlo simulations. When the two-dimensionalintegral was applied to the space station and several simplifying assumptions on the covariance matrices and encountergeometry were made, Alfriend et al. ${ }^{7}$ showed that the twodimensionalintegral can be artificially reduced to a one-dimensional integral involving the error function. This reduction in dimensionality is artificial in that the error function itself is defined as an integral. Chan ${ }^{5}$ found a single integral involving the error function that is more generally applicable. In the region where probability density is nearly uniform and the error function has acceptable accuracy, Leclair 8 found a simpler approximation to be useful. However, both Leclair found a simpler approximationto be useful. However, both Chan ${ }^{5}$ and LeClair ${ }^{8}$ point out that the error function formulation is not very useful because it converges too slowly in the region where the relative separationdistance is greater than the standard deviation of the probabilitydensity function. This can introduce unacceptably large numerical errors as well as sluggish computational performance. Thus, in practice the collision probability is obtained by numerically evaluating a two-dimensionalintegral of the combined probability density in the encounterplane. Collision probability prediction software has reached operationalstatus and is currently being used to monitor satellite collision risk with tracked space objects. ${ }^{10}$

The purpose of this work is to provide an accurate and efficient method to calculate orbital collision probability without making any simplifying assumptions. A formulation was developed that reduces the two-dimensional integral to a one-dimensional integral involving only a simple exponential function in the integrand. Instead of integrating over an area, one integrates around the perimeter of the area, thereby reducing the number of evaluations of the integrand and increasing the computational speed. This computational efficiency is particularlyadvantageous when large numbers of collision probability evaluations are performed.

This formulation differs from all others in that there is no need to assume a spherical shape to the space objects. Space objects of highly irregular shape can be handled readily because it is easy to define the perimeter over which the integral is performed. This differs significantly from the error function formulation, which assumes spherically symmetric space objects. ${ }^{5,7}$

The ability to handle asymmetric space objects is particularly helpful in computing collision probabilities of geostationary satellites that have large rectangular solar panels that are required for the considerable power needed for transmitting signals. Launch vehicles, which are also nonsphericalin shape, can be handled with this formulation as well.

The inclusion of satellite shape tends to reduce the predicted collision probability, and using this general method one can determine satellite or satellite appendageorientationto minimize collisionrisk. Therefore, in many cases it is possible to mitigate collision risk by a reorientation of an entire satellite or its appendages. This is far less risky than performing a collision avoidance maneuver. In addition, one would expect fewer launch vehicle holds due to collision risk because the collision probability is typically significantly lower and modeled more accurately using this formulation.

An efficient computer numerical implementation of the computation scheme was created and tested. Values of collision probability using this new method are in agreement with two probability estimation tools that are currently operational.

\section{Methodology Overview}
The collision risk to a space object of interest is assessed by first screening out cataloged objects that have no possibility of collision based on their orbital elements. Each one of the remaining objects is propagated while its proximity to the object of interest is checked against a critical distance to determine if a probability calculation is warranted. One such criterion is the overlapping of the three-sigma positional error ellipsoids of each space object. Once a potential collision is identified, the error covariancesand state vectors of each object near the point of closest approach are used to compute the collision probability. The method of computing collision probability is the subject of this paper.

Because the relative velocity of orbital objects at closest approach is very large compared to the relative accelerations, the relative velocity can be considered constant during the encounter period. The positionalerror of each object at closest approach is represented by a three-dimensional Gaussian probability density. The relative positional error of the satellites can be obtained by simply adding the error covariance matrices. Because the objects pass each other at constant velocity, the three-dimensional probability density is at constant velocity, the three-dimensional probability density is reduced to a two-dimensional distribution. That is, the probability density as a function of position along the velocity direction can be integrated yielding a two-dimensional Gaussian distribution in the encounter plane that is normal to the relative velocity vector.

The physical shape of each object is initially assumed to be spherical to be consistent with other probability estimation tools. The method is extended to irregularly shaped objects in a later section. The two spheres can be combined into one equivalent sphere having a radius equal to the sum of the radii of the two spheres. This equivalent sphere is termed a hard-body sphere because it represents the combined size of both objects. If the relative separation distance is less than the sum of the radii, a collision will occur. The combined hard-body sphere becomes a circle when projected onto the encounter plane. The hard-body circle is centered on the relative separation distance based on the state vectors of the objects at closest approach. The relative separation distance can be interpreted as a collision impact parameter. The hard-body circle can be interpreted as the collision cross section. The collision probability is obtained by integrating the probability density over the combined hard-body circle in the encounter frame.

A unique development of this work is the reduction of the area integral to a path integral about the perimeterof the hard-body circle. This is achieved by performing a coordinate rotation and a scale change to make the density distribution symmetric. The coordinate rotation does not alter the shape of the hard-body circle but changes its location. The subsequent scale change transforms the circular hard-body region into an elliptical region and alters its position.

The problem is reduced to integrating a symmetric probability density over an elliptical region. The symmetric form of the probability density enables the two-dimensionalintegral to be reduced to a one-dimensionalintegral. The form of the resulting one-dimension integral enables it to be converted into a path integral that greatly facilitates computer implementation.

\section{Analysis}
The uncertainty in the relative position between the objects is defined by a three-dimensionalGaussian distribution of the form
$$
\begin{aligned}
\rho(\boldsymbol{x}) &=\left[1 /(2 \pi)^{\frac{3}{2}} \sigma_{x} \sigma_{y} \sigma_{z}\right] \exp \left[-\left(x^{2} / 2 \sigma_{x}^{2}\right)\right.\\
&\left.-\left(y^{2} / 2 \sigma_{y}^{2}\right)-\left(z^{2} / 2 \sigma_{z}^{2}\right)\right]
\end{aligned}
$$
When the distribution is transformed to the encounter frame and integrated along the relative velocity direction, which is taken to be along the $Z$ axis, the three-dimensional Gaussian reduces to a two-dimensional Gaussian of the form
$$
h(\boldsymbol{x})=\left(1 / 2^{\frac{3}{2}} \pi \sigma_{x} \sigma_{y} \sigma_{z} \sqrt{a}\right) \exp \left[-e x^{2}-f y^{2}-g x y\right]
$$
The encounter coordinate frame in Eq. (2) is related to the frame defining the density in Eq. (1) by
$$
\boldsymbol{x}_{\text {sigma }}=U \boldsymbol{x}_{\text {encounter }}
$$
The parameters $a, e, f$, and $g$ are defined by
$$
\begin{gathered}
a=\frac{U_{13}^{2}}{2 \sigma_{x}^{2}}+\frac{U_{23}^{2}}{2 \sigma_{y}^{2}}+\frac{U_{33}^{2}}{2 \sigma_{z}^{2}} \\
e=\frac{U_{11}^{2}}{2 \sigma_{x}^{2}}+\frac{U_{21}^{2}}{2 \sigma_{y}^{2}}+\frac{U_{31}^{2}}{2 \sigma_{z}^{2}}-\frac{c^{2}}{4 a} \\
f=\frac{U_{12}^{2}}{2 \sigma_{x}^{2}}+\frac{U_{22}^{2}}{2 \sigma_{y}^{2}}+\frac{U_{32}^{2}}{2 \sigma_{z}^{2}}-\frac{d^{2}}{4 a}
\end{gathered}
$$
\includegraphics[max width=\textwidth]{2022_09_06_38c514da17d0f3d2cf74g-4}

Fig. 1 Collision probability density and relative position of the hardbody circle in the encounter plane.
$$
g=\frac{U_{11} U_{12}}{\sigma_{x}^{2}}+\frac{U_{21} U_{22}}{\sigma_{y}^{2}}+\frac{U_{31} U_{32}}{\sigma_{z}^{2}}-\frac{c d}{2 a}
$$
where
$$
\begin{aligned}
&c=\frac{U_{11} U_{13}}{\sigma_{x}^{2}}+\frac{U_{21} U_{23}}{\sigma_{y}^{2}}+\frac{U_{31} U_{33}}{\sigma_{z}^{2}} \\
&d=\frac{U_{12} U_{13}}{\sigma_{x}^{2}}+\frac{U_{22} U_{23}}{\sigma_{y}^{2}}+\frac{U_{32} U_{33}}{\sigma_{z}^{2}}
\end{aligned}
$$
$$
\begin{aligned}
&\alpha=(e+f) / 2-\sqrt{g^{2}+(f-e)^{2}} / 2 \\
&\beta=(e+f) / 2+\sqrt{g^{2}+(f-e)^{2}} / 2
\end{aligned}
$$
This rotation changes $\boldsymbol{q}$ to $\boldsymbol{q}_{r}$ as given by
$$
\boldsymbol{q}_{r}=T \boldsymbol{q}
$$
where $T$ is given by
$$
T=\left[\begin{array}{cc}
\cos (\phi) & \sin (\phi) \\
-\sin (\phi) & \cos (\phi)
\end{array}\right]
$$
and
$$
\begin{aligned}
&\cos (\phi)=\sqrt{\frac{1}{2}\left[1-\frac{(f-e)}{\sqrt{g^{2}+(f-e)^{2}}}\right]} \\
&\sin (\phi)=\pm \sqrt{\frac{1}{2}\left[1+\frac{(f-e)}{\sqrt{g^{2}+(f-e)^{2}}}\right]}
\end{aligned}
$$
where $U_{i j}, i, j=1,3$, are the elements of the transformation matrix $U$.

The collision probability density per unit area is given by $h(\boldsymbol{x})$ in Eq. (2) and is illustrated by the constant contour lines in Fig. 1. All of the uncertainty in relative position between the two objects, which is represented by $h(\boldsymbol{x})$, can be attributed to the first object, which is nominally located at the origin. The second object's location is defined by the relative displacement vector $q$ which is obtained by transforming the relative position vector at closest approach to the encounter frame. There is no uncertainty in $\boldsymbol{q}$ because all of the encounter frame. There is no uncertainty in $q$ because all of the uncertainty in relative position has been attributed to the first object for visualization purposes. The hard-body circle is centered on the second object located at $\boldsymbol{q}$. Because the actual position of the first object must lie within the hard-body circle for a collision to occur, the total collision probability is obtained by integrating the probability density over the hard-body circle. This is achieved by using a step function $u(\boldsymbol{x}-\boldsymbol{q})$, to define the hard-body circle, where $u(\boldsymbol{x}-\boldsymbol{q})=1$, if the absolute value of $\boldsymbol{x}-\boldsymbol{q}$ is less than the sum of the radii of the two objects and $u(\boldsymbol{x}-\boldsymbol{q})=0$ otherwise. The collision probability (prob) is obtained by integrating the product of $h(\boldsymbol{x})$ and $u(\boldsymbol{x}-\boldsymbol{q})$,
$$
\operatorname{prob}=\iint h(\boldsymbol{x}) u(\boldsymbol{x}-\boldsymbol{q}) \mathrm{d} \boldsymbol{x}
$$
This problem has the property of reciprocity because the same answer results if the first and second objects are switched. That is, if all of the relative position uncertainty was attributed to the second object and the hard-body circle was centered on the first object, one would also obtain Eq. (10).

Equation (10) is equivalent to expressions obtained by other analysts. ${ }^{5-9}$ In practice Eq. (10) is evaluated by two-dimensional numerical integration. Nevertheless, the collision probability calculation can be greatly simplified by reducing the integration over the hard-body area to an integration about a contour enclosing the area. This is achieved by performing a rotation followed by a scale change in the encounter plane.

A coordinate rotation is performed to eliminate the cross term in $h$ to yield
$$
h(\boldsymbol{x})=\left(1 / 2^{\frac{3}{2}} \pi \sigma_{x} \sigma_{y} \sigma_{z} \sqrt{a}\right) \exp \left[-\alpha x^{2}-\beta y^{2}\right]
$$
The correct sign in Eq. (17) is determined by ensuring that the cross term in Eq. (11) is zero, that is,
$$
2(f-e) \sin (\phi) \cos (\phi)+g\left[\cos (\phi)^{2}-\sin (\phi)^{2}\right]=0
$$
A scale change in the $y$ axis is made to make $h(x)$ symmetric:
$$
\begin{gathered}
y=\sqrt{(\alpha / \beta)} y^{\prime} \\
h(\boldsymbol{x})=\left(\sqrt{\alpha} / 2^{\frac{3}{2}} \pi \sigma_{x} \sigma_{y} \sigma_{z} \sqrt{a \beta}\right) \exp \left[-\alpha x^{2}-\alpha y^{\prime 2}\right]
\end{gathered}
$$
The $y$ component of $\boldsymbol{q}_{r}, q_{r}(2)$, is multiplied by a scale factor given by
$$
q_{r s}(2)=\sqrt{(\beta / \alpha)} q_{r}(2)
$$
The $y$ component of the hard-body circle is also multiplied by the scale factor resulting in
$$
(x / s)^{2}+(y / s)^{2}(\alpha / \beta)=1
$$
where $s$ is the initial hard-body radius of the combined objects.

Using Eq. (20) in Eq. (10) and converting to polar coordinates, one finds
$$
\operatorname{prob}=\frac{\sqrt{\alpha}}{2^{\frac{3}{2}} \pi \sigma_{x} \sigma_{y} \sigma_{z} \sqrt{a \beta}} \iint_{\text {ellipse }} \exp \left(-\alpha r^{2}\right) r \mathrm{~d} r \mathrm{~d} \theta
$$
Here the region of integration is defined by the ellipse given by Eq. (22). The advantage of having a symmetric probability density functionis now clearbecause the integrationover $r$ can be performed immediately yielding,
$$
\operatorname{prob}=\frac{1}{4 \sqrt{2} \pi \sigma_{x} \sigma_{y} \sigma_{z} \sqrt{a \beta \alpha}}\left(\int_{s 2} \exp \left(-\alpha r^{2}\right) \mathrm{d} \theta-\int_{s 1} \exp \left(-\alpha r^{2}\right) \mathrm{d} \theta\right)
$$
where $s 1$ and $s 2$ are contoursdefining the hard-bodyellipse as shown in Fig. 2. The usual integration technique involves solving for $r$ for each value of $\theta$ along the contours $s 1$ and $s 2$ and determining the endpoints where $s 1$ joins $s 2$. These tedious computations can be avoided by noting that Eq. (24) is equivalent to the closed path integral defined by
$$
\text { prob }=\frac{-1}{4 \sqrt{2} \pi \sigma_{x} \sigma_{y} \sigma_{z} \sqrt{a \beta \alpha}} \oint_{\text {ellipse }} \exp \left(-\alpha r^{2}\right) \mathrm{d} \theta
$$
\includegraphics[max width=\textwidth]{2022_09_06_38c514da17d0f3d2cf74g-5}

Fig. 2 Contours $s 1$ and $s 2$ defined by the hard-body ellipse.

\includegraphics[max width=\textwidth]{2022_09_06_38c514da17d0f3d2cf74g-5(1)}

Fig. 3 Contour integration path for the case in which the origin lies within the hard body.

where the minus sign is introduced to be consistent with integrating around the contour in the counterclockwisedirection. Equation (25) can be simplified by evaluating the coefficient of the integral, which resultsin Eq. (26a). If the origin is containedin the hard-bodyellipse, the line integral includes an infinitesimal circle about the origin that contributes $a+2 \pi$ to the value of the integral as shown in Fig. 3. In this case Eq. (26a) is replaced with Eq. (26b). When the origin is excluded from the hard-body ellipse,
$$
\text { prob }=\frac{-1}{2 \pi} \oint_{\text {ellipse }} \exp \left(-\alpha r^{2}\right) \mathrm{d} \theta
$$
When the origin is included in the hard-body ellipse,
$$
\text { prob }=1-\frac{1}{2 \pi} \oint_{\text {ellipse }} \exp \left(-\alpha r^{2}\right) \mathrm{d} \theta
$$
The reduction of the probability calculation to a simple contour integral involving only a scalar exponential in the integrand given by Eq. (26) greatly increases computational efficiency. In addition, the ease of defining the closed contour enables the methodology to be applied to the general case of non-sphericalobjects. An example of a non-spherical problem is presented in a subsequent section.

\section{Numerical Implementation}
The form of the integral in Eq. (26) enables a very efficient computational procedure to be employed. Define a point on a unit circle as $\boldsymbol{X}=(1,0)$. A second point is obtained by multiplying $\boldsymbol{X}$ by an infinitesimal rotation matrix,
$$
\begin{gathered}
\boldsymbol{X}^{\prime}=R \boldsymbol{X} \\
R=\left[\begin{array}{cc}
\cos (\varepsilon) & -\sin (\varepsilon) \\
\sin (\varepsilon) & \cos (\varepsilon)
\end{array}\right]
\end{gathered}
$$
where $\varepsilon$ is a small angle.

Both vectors are multiplied by scale factors to define the hardbody ellipse.
$$
\begin{aligned}
& \boldsymbol{X}_{m}^{\prime}=M \boldsymbol{X}^{\prime}, \quad \boldsymbol{X}_{m}=M \boldsymbol{X} \\
& M=\left(\begin{array}{cc}s & 0 \\0 & s \sqrt{\beta / \alpha}\end{array}\right)
\end{aligned}
$$
The distance of each point on the ellipse to the origin of the encounter plane is found by adding the displacement vector to the ellipse vector:
$$
\begin{aligned}
&\boldsymbol{X}_{e}^{\prime}=\boldsymbol{X}_{m}^{\prime}+\left[\begin{array}{c}
q_{r}(1) \\
q_{r s}(2)
\end{array}\right] \\
&\boldsymbol{X}_{e}=\boldsymbol{X}_{m}+\left[\begin{array}{c}
q_{r}(1) \\
q_{r s}(2)
\end{array}\right]
\end{aligned}
$$
The angle between the two vectors, $\mathrm{d} \theta$, is found by noting its relationship to the cross product between the two vectors:
$$
\boldsymbol{X}_{e} \times \boldsymbol{X}_{e}^{\prime}=\left|\boldsymbol{X}_{e}\right|\left|\boldsymbol{X}_{e}^{\prime}\right| \sin (\mathrm{d} \theta)
$$
After rearranging Eq. (33) one finds
$$
\mathrm{d} \theta=\sin ^{-1}\left(\frac{\boldsymbol{X}_{e} \times \boldsymbol{X}_{e}^{\prime}}{\left|\boldsymbol{X}_{e}\right|\left|\boldsymbol{X}_{e}^{\prime}\right|}\right)
$$
The integrand (int) is evaluated at the midpoint of the two vectors:
$$
\text { int }=\exp \left\{-\alpha\left[\left(\boldsymbol{X}_{e}+\boldsymbol{X}_{e}^{\prime}\right) / 2\right]^{2}\right\}
$$
The integral is evaluated by summing values of the integrand times $\mathrm{d} \theta$ for each pair of points around the ellipse. This is accomplished by multiplying $\boldsymbol{X}$ and $\boldsymbol{X}^{\prime}$ by the rotation matrix $R$ and repeating the steps from Eq. (29) as before. The numerical value of the closed-path integral (sum) is
$$
\operatorname{sum}=\operatorname{sum}+(\text { int })(d \theta)
$$
Once one complete cycle about the ellipse is made, the probability when the origin is excluded from the hard body is given by Eq. (26) as
$$
\text { prob }=-\operatorname{sum} / 2 \pi
$$
and when the origin is included in the hard-body as
$$
\operatorname{prob}=1-\operatorname{sum} / 2 \pi
$$

\section{Numerical Results}
The computation technique was implemented on a computer and test cases were run. The collision probability between a launch vehicle with a 200-m keep-out radius and cataloged space objects was computed. The launch vehicle keep-out radius was artificially increased from 20 to $200 \mathrm{~m}$ to stress each algorithm. The radius of each space object was based on its radar cross section (RCS) as shown in Table 1 . Results of the model presented here are in very close agreement with results obtained from an operationalcomputer simulation named PERFCT option 5, which is based on a NASA model. Results differ by less than $1 \%$, wher a wide range of obmodel. Results differ by less than $1 \%$ over a wide range of object size and error covariance matrices. PERFCT option 5 performs a two-dimensional numerical integration over the hard-body circle, which is equivalent to evaluating Eq. (10). Another model, PERFCT option 3, evaluates collision probability by assuming the collision probability density is constant over the hard-body circle and is equal to its value at the center of the hard-body circle. Thus, the collision probability density at the center of the hard-body circle is multiplied by the area of the circle. A comparison of model results is shown in Table $1 .$

Peterson (private communication) evaluated the computational efficiency by executing both 1,000 and 10,000 collision probability evaluations and recording the associated CPU times obtained from a Sun Ultra 60 machine using a 360-MHz Ultra Sparc 2 processor. The PERFCT option 5 had CPU times of $5.60$ and $57.52 \mathrm{~s}$, respectively. The current model had CPU times of $0.99$ and $10.12 \mathrm{~s}$, respectively. Thus, the current model evaluated collision probability about $5.7$ times faster. However, Peterson found that PERFCT option 5 had 720 function calls to evaluate the area integral, whereas the current model had 400 function calls to evaluate the contour integral. Because the perimeter is proportional to the square root of the area, the number of function calls was reduced from 400 to the square root of 400 or 27 to make the integration schemes more comparable. Using a case with a relatively high collision probability that might lead to a collisionavoidancemaneuver, PERFCT option 5 yields a collision probability of $0.00193$, whereas the current model Table 1 Collision probability results ${ }^{a}$

\includegraphics[max width=\textwidth]{2022_09_06_38c514da17d0f3d2cf74g-6}

${ }^{a}$ Launch object radius: $200 \mathrm{~m} .$

yields $0.001792$ for 400 steps and $0.001791$ for 27 steps. Thus, reducing the number of steps does not degrade accuracy significantly. Peterson found that the CPU time is reduced from $0.99$ to $0.26 \mathrm{~s}$ when 27 rather than 400 steps are used on the set of 1000 cases. Thus with 27 steps, the current model evaluates collision probability 21 times faster than PERFCT option 5 .

\section{Asymmetric Objects}
The assumption that the object of interest is spherical in shape simplifies the analysis because detailed geometry and attitude information is not required. Although this assumption is reasonable for compact objects, it introduces significant error for objects with large geometric asymmetries such as launch vehicles or satellites with large solar panels. The secondary object is considered spherical in shape because its geometry and attitude are usually not known.

Except for the shape of the combined hard body, the method of calculating collision probability remains valid. Instead of a hardbody sphere, the physical shape of the primary object is defined by a grid of points referenced to its nominal position in the Earthcentered inertial (ECI) coordinate frame. The grid points define the vertices of a set of polygons that form a completely closed surface. This closed surface is representative of the actual shape of the satellite. Each polygonis defined by a sequenceof points ordered so that its perimeter is traversed in the counterclockwise direction when viewed from outside the closed surface. The combined hard body is found by adjusting the coordinate of each primary object body is found by adjusting the coordinate of each primary object grid point to account for the secondary object's radius. Thus, the shape of the combined hard body represented by the grid points expands to enclose the true hard body, which actually has rounded corners. This adjustment results in a good approximation to the shape of the combined hard body, as long as the secondary object is smaller than the primary. For cases involving secondary objects significantly larger than the primary objects, one can assume both objects are spherically symmetric to simplify the calculation without much loss of accuracy. The effect of secondary object radius on collision probability can be observed in the numerical test cases presented in Table $2 .$

Once the grid points are properly adjusted, the closed surface is then projected to the encounter plane. This is achieved by project- Fig. 4 Integration contours for a rectangular solid projected to the encounter plane. ing each polygon to the encounter plane and retaining only those surfaces whose sequence of points traverse the perimeterin the counterclockwise direction. Thus, only half of the polygonal surfaces are retained. The relative displacement between the objects in the encounter frame is added to each grid point so that the projected hard body is referenced to the origin of the probability density. The resulting set of grid points represent the combined hard body projected to the encounter frame.

The total probability is obtained by integrating the probability density over each projected polygonal surface and summing all of the contributions. As was done earlier, the computation is simplified by performing a coordinate rotation and a scale change to make the probability density distribution symmetric. The coordinate rotation does not alter the shape of the polygonal surfaces, but changes their orientation and location. The subsequent scale change alters the position and shape of the polygons. The symmetric form of the probability density enables integration over each polygonal surface to be reduced to a one-dimensional integral. The form of the onedimension integral enables it to be converted into a path integral along the perimeter that greatly facilitates computer implementation. Figure 4 illustrates that a rectangular solid shape forms three polygonal surfaces when projected to the encounter plane. A counterclockwise path integral as indicated by the arrows is performed about each polygon. Contributionsfrom each polygon are combined to obtain the total collision probability:
$$
\operatorname{prob}=\sum \operatorname{prob}_{i}
$$
Table 2 Collision probability results for an asymmetric launch vehicle

\includegraphics[max width=\textwidth]{2022_09_06_38c514da17d0f3d2cf74g-7}

When the origin is excluded from the hard body,
$$
\operatorname{prob}_{i}=\frac{-1}{2 \pi} \oint_{\text {polygon }} \exp \left(-\alpha r^{2}\right) \mathrm{d} \theta
$$
When the origin is included in the hard-body,
$$
\operatorname{prob}_{i}=1-\frac{1}{2 \pi} \oint_{\text {polygon }} \exp \left(-\alpha r^{2}\right) \mathrm{d} \theta
$$

\section{Numerical Implementation}
Numerical implementation for the asymmetric case is similar to that of the symmetric case except for the path of integration. In the symmetric case, one traverses an elliptical shape representing the combined hard body. For the asymmetrical case, one traverses a set of polygonal surfaces that represent the combined hard-body polygon. The path integral for each individual polygonal surface is evaluated separately. The evaluation of the path integral proceeds by considering two adjacent vertices $\boldsymbol{x} 1$ and $\boldsymbol{x} 2$ of a polygonal surface. Two adjacent vectors $\boldsymbol{X}_{n}^{\prime}$ and $\boldsymbol{X}_{n}$ lie between $\boldsymbol{x} \mathbf{1}$ and $\boldsymbol{x} 2$ and are defined by
$$
\begin{aligned}
X_{n}^{\prime} &=\frac{\boldsymbol{x 2}(n)+\boldsymbol{x} \mathbf{1}(J-n-1)}{J-1} \\
X_{n} &=\frac{\boldsymbol{x 2}(n-1)+\boldsymbol{x} \mathbf{1}(J-n)}{J-1}
\end{aligned}
$$
where $J$ is the number of integration steps between $\boldsymbol{x} 1$ and $\boldsymbol{x} \mathbf{2}$. As $n$ goes from 1 to $J-1, \boldsymbol{X}_{n}^{\prime}$ and $\boldsymbol{X}_{n}$ move from $\boldsymbol{x} \mathbf{1}$ to $\boldsymbol{x} \mathbf{2}$. The angle between the two vectors, $\mathrm{d} \theta$, is found by noting its relationship to the cross product between the two vectors:
$$
\boldsymbol{X}_{n} \times \boldsymbol{X}_{n}^{\prime}=\left|\boldsymbol{X}_{n}\right|\left|\boldsymbol{X}_{n}^{\prime}\right| \sin (\mathrm{d} \theta)
$$
After rearranging Eq. (42), one finds
$$
\mathrm{d} \theta=\sin ^{-1}\left(\frac{\boldsymbol{X}_{n} \times \boldsymbol{X}_{n}^{\prime}}{\left|\boldsymbol{X}_{n}\right|\left|\boldsymbol{X}_{n}^{\prime}\right|}\right)
$$
The integrand is evaluated at the midpoint of the two vectors:
$$
\text { int }=\exp \left\{-\alpha\left[\left(\boldsymbol{X}_{n}+\boldsymbol{X}_{n}^{\prime}\right) / 2\right]^{2}\right\}
$$
The integral is evaluated by summing values of the integrand times $\mathrm{d} \theta$ for each pair of points between the vertices. The same procedure is performed for each pair of vertices as the polygon perimeter is traversed in the counterclockwise direction. As before, the contributions are summed to obtain the total collision probability:
$$
\operatorname{sum}_{i}=\operatorname{sum}_{i}+(\text { int })(\mathrm{d} \theta)
$$
Once one complete cycle about each polygonal surface is made, the probability when the origin is excluded from the hard body is given by Eq. (39) as
$$
\operatorname{prob}_{i}=-\operatorname{sum}_{i} / 2 \pi
$$
and when the origin is included in the hard-body as
$$
\operatorname{prob}_{i}=1-\operatorname{sum}_{i} / 2 \pi
$$
Equation (38) is then use to obtain the total collision probability.

\section{Asymmetric Example}
The computation technique for the asymmetric case was implemented on a computer and test cases were run. To illustrate differences in collision probability between the symmetric and asymmetric cases, the same set of cases involving the collision probability between a launch vehicle with a 200-m keep-out radius and cataloged space objects was computed. For the asymmetric case, the launch vehicle shape was defined as a rectangular solid $200 \times 35 \times 35 \mathrm{~m}$. The longitudinal axis (largest dimension) was $200 \times 35 \times 35 \mathrm{~m}$. The longitudinal axis (largest dimension) was initially aligned with the $Z$ axis in the ECI coordinate system. The other two dimensions were aligned with the $X$ and $Y$ axes. Note that only eight points are needed to define this shape. The radius of each space object was based on its radar cross section as shown in Table 2 . The grid points defining the launch vehicle were adjusted to account for the size of each space object. A single rotation was used to reorient the grid of points to align the longitudinal axis with the velocity vector. Table 2 illustrates the differences in collision probabilities between a spherically symmetric launch vehicle and an asymmetric launch vehicle. Notice that large space objects can greatly increase the probability for the asymmetric case. This is due to the conservative manner in which the launch vehicle's grid points were adjusted to account for the size of each space object. In most cases, the asymmetric shape reduces the collision probability significantly. Thus, one may expect fewer launch holds for collision avoidance when using the higher fidelity asymmetric geometry.

\section{Conclusions}
A general method for calculating satellite collision probability was developed. The probability calculation was reduced to a single closed-path integral of a form that allows efficient numerical processing. The technique was implemented in a computer program, and a set of test cases involving spherically symmetric space objects were run. The results were found to be in very close agreement jects were run. The results were found to be in very close agreement with those obtained using a NASA-based model. The computational to be roughly 20 times faster than current operational codes.

The methodology, which is applicable to objects having complex geometric shapes, was applied to an asymmetric launch vehicle. Because this is the only formulation that treats asymmetric space objects, comparisons with other formulations could not be made. However, results were compared to those obtained assuming a spherically symmetric hard body and found to be lower in most cases. Therefore, fewer launch holds due to collision probability are expected for the more accurate asymmetric hard-body model.

The method also has advantages when applied to satellites with large appendages. Vehicle or appendage attitude of minimum collision probabilitycan be \href{http://determined.In}{determined.In} some cases, it may be possible to reduce collision probability by adjusting the attitude of the appendage or vehicle before closest approach. In this manner, a costly collision avoidance maneuver can be prevented.

\section{Acknowledgments}
Thanks are extended to Glenn Peterson of The Aerospace Corporation for his private communication assessing the improved computational efficiency resulting from this methodology. Thanks are extended for the private communications from D. L. Oltrogge of The Aerospace Corporation, for providing information on the operational models, and J. L. Foster of the Barrios Corporation, for an informative discussion of the NASA model. Kenneth Chan, Vladimir Chobotov, and Robert Gist of The Aerospace Corporation are also acknowledgedfor carefully reviewing this paper and providing valuable suggestions.

\section{References}
${ }^{1}$ Committee on Space Shuttle Meteoroid/Debris Risk Management, "Protecting the Space Shuttle from Meteoroids and Orbital Debris," National Academy Press, Washington, DC, 1997, pp. 36-41.

"Woodburn, J.," Determination of Close Approach for Earth Fixed Launch Trajectories," American Astronautical Society, Rept. AAS 90-134, Feb. 1998

"Gist, R. G., and Oltrogge, D. L., "The Collision Vision Prototype Assessment System," Proceedings of the 1998 Space Control Conference, Lincoln Lab., Massachusetts Inst. of Technology, Lexington, MA, 1998, p. $23 .$

${ }^{4}$ Alby, F., and Mesnard, R., "Monitoring of On-Orbit Collision Risk," International Academy of Astronautics, Rept. IAA-97-IAA.6.4.05, International Astronautical, Oct. $1997 .$

${ }^{5}$ Chan, K., "Collision Probability Analysis for Earth Orbiting Satellites," Advances in the Astronautical Sciences, Vol. 96, Univelt, San Diego, CA, 1997, pp. 1033-1048.

Chobotov, V. A. (ed.), Orbital Mechanics, 2nd ed., AIAA, Reston, VA, 1996 , p. $313 .$

${ }^{7}$ Alfriend, K. T., Akella, M. R., Lee, D., Frisbee, J., and Foster, J. L., "Probability of Collision Error Analysis," Space Debris, Vol. 1, No. 1, 1999, pp. 21-35.

"LeClair, R. A., "Probability of Collision in the Geostationary Orbit," Proceedings of the 2000 Space Control Conference, Lincoln Lab., Massachusetts Inst. of Technology, Lexington, MA, 2000, p. 85 .

${ }^{9}$ Berend, N., "Estimation of the Probability of Collision Between Two Catalogued Orbiting Objects," Advances in Space Research, Vol. 23, No.1, 1999 , pp. 243-247.

${ }^{10}$ Gist, R. G., and Oltrogge, D. L., "Collision Vision: Covariance Modeling and Intersection Detection for Spacecraft Situational Awareness," American Astronautical Society, Rept. AAS-351, Aug. $1999 .$


\end{document}
